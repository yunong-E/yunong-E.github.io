---
title: 정보누수(Leakage)
author: yun
date: 2022-11-23
categories: [Blogging, Study, Ai, Summary]
tags: [study, python, k-fold, loocv]
---

# 목표
* 교차검증을 사용하는 이유가 무엇일까?
  1. 내가 가지고 있는 데이터셋에 적합한 모델을 찾기 위해?
  2. 어떤 하이퍼파라미터를 사용할 것인지 알기 위해?

<br/>

# 키워드
- [x] 정보누수(Data Leakage)

<br/>

# NOTE
* 지도학습을 통해 문제를 풀고자 하면 `타겟`을 명확하게 해야한다.
* 지도학습은 회귀, 분류문제로 풀 수 있다.
* 회귀문제로 보이는 타겟특성도 분류문제로 바꿀 수 있고, 그 반대의 경우도 있다.
* 정보의 누수는 과적합을 일이크기 실제 테스트 데이터에서 성능이 급격하게 떨어지는 결과를 초래한다.

<br/>

### 타겟설정
* 문제는 무엇이고 목적은 무엇인지? -> 타겟을 결정 -> 회귀/분류 어떤 것으로 풀 것인지 선택 -> 문제에 적합한 평가지표 선택.
* 기승전결 중 `기`와 `결`도 무엇보다 중요합니다. 어필할 수 있어야 합니다.

<br/>

# 데이터 리키지
* 데이터 리키지가 발생하는 두 가지 경로
1. 타겟 리키지.<br/>
  a. 타켓정보가 학습에 포함이 되어있음
    * rating 이라는 타겟정보가 학습에 포함이 되어있었음. (렉쳐노트 n231)
    * 수료여부예측 모델 -> 조기하차 feature = 수료 못함.


  b. 학습 데이터가 예측 시 못 쓰는 feature를 반영하는 경우
    * 암진단 여부를 확인해야 하는데 항암치료 여부 feature가 이미 암을 진단받았다는 사실(암진단 이후)를 명시함.  

<br/>

2. Train - Test contamination
  * 전처리

<br/>

## 평가지표
* 회귀: mae, $$r^2$$, mse, rmse ...

* 분류: f1-score, accuracy, precision, recall, auc ...

* 불균형 타겟
  * 타겟이 불균형할 때 정확도만 사용하면 안되는 이유?
    * 예측에 대한 catch를 제대로 하지 못함. 정확도가 0.99로 나올 수 있음.
    * 희귀값에 대한 예측을 제대로 하지 못함.

<br/>

## 타겟 분포 불균형
* 분류 (바이너리, 이산형, 0-1)
  * **가중치**
    * 가중치를 줘서 1:99 비율의 데이터를 5:5로 ***보이게하여*** 비율 1의 데이터를 잘 catch 할 수 있게 함.
    * `class_weight = 'balanced'`
  * **샘플링**
    * 오버샘플링: 1:99 -> 99:99 ('현실에 없는 데이터를 사용하기 때문에 로버스트하지 않다' 라는 평가가 있다.)
    * 언더샘플링  1:99 -> 1:1

* 회귀
  * 기사의 댓글 수, 연봉 등.. 현실세계에서는 `Positively skewed` 형태의 분포가 많다. 로그변환을 해주자.
  * `TransformedTargetRegressor`
  * 로그변환을 한다고 ***무조건 정규분포 형태를 띄는 것은 아니다***. 왜도에 따라서 다름.
  * 리니어모델의 경우 왜도가 심하면 `log transform` 하면 좋다.

<br/>

> Negatively Skewed의 경우는 어떻게 변환을 하면 될까? 
<br/>

-> 로그 변환

<br/>
